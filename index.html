<!DOCTYPE html>
	<head>
		<title></title>
	</head>
	<body>
		<div id="chatWindow"></div>
        <form name="sender" action="">
            <input id="message"  type='text' name='message' value="Hello World!" />
            <button id='send'>Send</button>
        </form>

        <script src="/socket.io/socket.io.js"></script>
        <script>
            var socket = io.connect('http://localhost');

            document.getElementById("send").onclick = function(event) {
                var message = document.getElementById("message").value;
                console.log("sendMessage called with:" + JSON.stringify(message));

                // TODO: Broadcast to everyone
                socket.emit('chat', {message: message} );
                // TODO: Why's send not workking?
                io.sockets.emit('chat', {message: message} );
            }

            //socket.on('update', function (data) {
		    socket.on('message', function (data) {
                var div = document.createElement("div");
                div.innerHTML = data.id +" "+ data.message;

                var chat = document.getElementById("chatWindow");
                chat.appendChild(div);
		    });
            // TODO: store id on server http://stackoverflow.com/questions/7702461/socket-io-custom-client-id
        </script>
	</body>
</html>
